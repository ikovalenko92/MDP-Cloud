package com.mdp.example.KafkaExample;

import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;

import javax.json.Json;
import javax.json.JsonArray;
import javax.json.JsonObject;
import javax.json.JsonReader;
import javax.json.JsonValue;

public class JsonToString{
	public static String GetKafkaMessage() {
		// Initialize this array to check later
		JsonArray array = null;

		// Use try-catch to avoid RunTimeError
		// when the file doesn't exist
		// or somehow the program cannot open the file
		try {
			InputStream fis = new FileInputStream("SampleJson.JSON");
			JsonReader jsonReader = Json.createReader(fis);
			array = jsonReader.readArray();
			jsonReader.close();
			fis.close();
		} catch (Exception e) {}

		// This happens when program fails to open file
		if (array == null) return null;

		// Get data from JSON object
		JsonObject object = array.getJsonObject(0);
		String TagName = object.getString("TagName");
		String TagValue = object.getString("TagValue");
		String Timestamp = object.getString("TimeStamp");
		String KafkaMessage = Timestamp + " " + TagName + " " + TagValue;
		return KafkaMessage;
	}
}

